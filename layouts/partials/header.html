{{- /* theme-toggle is enabled */}}
{{- if (not site.Params.disableThemeToggle) }}
{{- /* theme is light */}}
{{- if (eq site.Params.defaultTheme "light") }}
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>
{{- /* theme is dark */}}
{{- else if (eq site.Params.defaultTheme "dark") }}
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>
{{- else }}
{{- /* theme is auto */}}
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
{{- end }}
{{- /* theme-toggle is disabled and theme is auto */}}
{{- else if (and (ne site.Params.defaultTheme "light") (ne site.Params.defaultTheme "dark"))}}
<script>
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
{{- end }}

<header class="header">
    <nav class="nav">
        <div class="logo">
            {{- $label_text := (site.Params.label.text | default site.Title) }}

            {{- /* Only display site title in header if NOT on homepage */}}
            {{- if not .IsHome }}
            <a href="{{ "" | absLangURL }}" accesskey="h" title="{{ $label_text }}">
                {{- if site.Params.label.icon }}
                    {{- $img := resources.Get site.Params.label.icon }}
                    {{- if $img }}
                        {{- $processableFormats := (slice "jpg" "jpeg" "png" "tif" "bmp" "gif") -}}
                        {{- if hugo.IsExtended -}}
                            {{- $processableFormats = $processableFormats | append "webp" -}}
                        {{- end -}}
                        {{- $prod := (hugo.IsProduction | or (eq site.Params.env "production")) }}
                        {{- if and (in $processableFormats $img.MediaType.SubType) (eq $prod true)}}
                            {{- if site.Params.label.iconHeight }}
                                {{- $img = $img.Resize (printf "x%d" site.Params.label.iconHeight) }}
                            {{ else }}
                                {{- $img = $img.Resize "x30" }}
                            {{- end }}
                        {{- end }}
                        <img src="{{ $img.Permalink }}" alt="" aria-label="logo"
                            height="{{- site.Params.label.iconHeight | default "30" -}}"
                            width="{{- site.Params.label.iconHeight | default "30" -}}">
                    {{- else }}
                        <img src="{{- site.Params.label.icon | absURL -}}" alt="" aria-label="logo"
                            height="{{- site.Params.label.iconHeight | default "30" -}}"
                            width="{{- site.Params.label.iconHeight | default "30" -}}">
                    {{- end }}
                {{- end }}
                {{- $label_text -}}
            </a>
            {{- end }}

            <div class="logo-switches">
                {{- if (not site.Params.disableThemeToggle) }}
                    <!-- theme toggle button -->
                {{- end }}

                {{- $lang := .Lang }}
                {{- with site.Home.Translations }}
                    <ul class="lang-switch">
                        {{- range . }}
                            {{- if ne $lang .Lang }}
                                <li>
                                    <a href="{{ .Permalink }}">
                                        {{ .Lang | title }}
                                    </a>
                                </li>
                            {{- end }}
                        {{- end }}
                    </ul>
                {{- end }}
            </div>
        </div>

        {{- $currentPage := . }}
        <ul id="menu">
            {{- range site.Menus.main }}
                <li>
                    <a href="{{ .URL | absLangURL }}">
                        <span {{ if eq (.URL | absLangURL) ($currentPage.Permalink | absLangURL) }} class="active" {{ end }}>
                            {{- .Name -}}
                        </span>
                    </a>
                </li>
            {{- end }}
        </ul>

        <!-- Optional: You can include social icons here if you want them next to the logo -->
        {{- if not .IsHome }}
            {{- partial "social_icons.html" -}}
        {{- end }}
    </nav>
</header>

